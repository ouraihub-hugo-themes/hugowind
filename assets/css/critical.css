/**
 * 关键 CSS - 内联到 HTML 中
 * 用于优化 Core Web Vitals
 * 需求: 5.1, 10.5
 * 
 * LCP 优化: 最小化首屏渲染阻塞
 * CLS 优化: 预留布局空间防止偏移
 * FID 优化: 减少主线程阻塞
 */

/* ========== 基础重置 - 防止 FOUC ========== */
html {
  visibility: visible;
  opacity: 1;
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

/* 暗色模式基础 - 防止闪烁 */
html.dark {
  color-scheme: dark;
  background-color: #0f172a;
  color: #f1f5f9;
}

html:not(.dark) {
  color-scheme: light;
  background-color: #ffffff;
  color: #1e293b;
}

/* ========== CLS 优化 - 布局稳定性 ========== */

/* 基础布局 */
body {
  margin: 0;
  min-height: 100vh;
  line-height: 1.5;
}

/* Header 固定尺寸 - 防止 CLS */
#header {
  position: sticky;
  top: 0;
  z-index: 50;
  min-height: 64px;
  contain: layout style;
}

/* Hero 区域预留空间 */
.hero-section {
  min-height: 100vh;
  min-height: 100dvh;
}

/* 图片 CLS 防护 */
img {
  max-width: 100%;
  height: auto;
  display: block;
}

/* 未指定尺寸的图片使用默认宽高比 */
img:not([width]):not([height]):not([style*="aspect-ratio"]) {
  aspect-ratio: 16 / 9;
  object-fit: cover;
}

/* 视频和 iframe CLS 防护 */
video, iframe {
  max-width: 100%;
  aspect-ratio: 16 / 9;
}

/* 文章卡片预留高度 */
.post-card {
  min-height: 320px;
  contain: layout;
}

/* 分页组件预留高度 */
.pagination {
  min-height: 48px;
}

/* ========== 字体加载优化 ========== */
@font-face {
  font-family: 'Inter';
  font-style: normal;
  font-weight: 400 800;
  font-display: swap;
  src: local('Inter'), local('Inter-Regular');
}

/* 字体回退栈 - 减少 CLS */
body {
  font-family: 'Inter', ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
}

/* ========== 骨架屏占位 ========== */
.skeleton {
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s infinite;
}

html.dark .skeleton {
  background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%);
  background-size: 200% 100%;
}

@keyframes skeleton-loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* ========== 内容可见性优化 ========== */
/* 延迟渲染屏幕外内容 */
.content-visibility-auto {
  content-visibility: auto;
  contain-intrinsic-size: auto 500px;
}
